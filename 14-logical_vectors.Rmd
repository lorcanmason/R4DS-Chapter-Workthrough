# Logical Vectors

**Learning objectives:**

-   What are Vectors and Why are we talking about Logical Vectors

-   How to use logical vectors & Boolean Algebra in

    -   Comparison

    -   Identifying missing values

-   What are the logical summary functions we could leverage in R?

-   Conditional Transformations using `if_else()` and `case_when()` functions

## What are Logical Vectors

-   Vectors in R are the same as the arrays in C language, which are used to hold multiple data values of the same type

-   The mental model for using Logical Vectors

    -   Defining constraints on your data to answer Binary Questions

## How to use logical vectors & Boolean Algebra

![](images/14_venn_diagrams.png)

-   Combining logical vectors using Boolean algebra

    -   Venn diagram here shows the logical relations between logical vectors

### Comparison

-   numeric comparison creates logical vectors, and you can see that in the following example

```{r}
library(tidyverse)
library(nycflights13)
```

-   There is an intermediate execution step that forma the logical vector behind the scenes when you use `filter()`

```{r}
flights |> filter(dep_time > 600 & dep_time < 2000 & abs(arr_delay) < 20)
```

-   To separate this intermediate step in it's own variable we use `mutate`

```{r}
flights |> mutate( daytime = dep_time > 600 & dep_time < 2000, approx_ontime = abs(arr_delay) < 20, .keep = "used" )
```

-   R doesn't round by default the float numeric value, but R console is rounding close number to integers

    -   To round numbers we could use `dplyr::near` function

```{r}
x <- c(1 / 49 * 49, sqrt(2) ^ 2)
typeof(x) # double
```

```{r}
print(x)
print(x,digits = 16)

```

### Identifying Missing Values

-   There is no indication what's so ever about the `NA` value if it's a logical vector, although the author says that a missing value in a logical vector means that the value could either be `TRUE` or `FALSE`
-   `TRUE | TRUE` and `FALSE | TRUE` are both `TRUE`, so `NA | TRUE` must also be `TRUE`. Similar reasoning applies with `NA & FALSE`

```{r}
df <- tibble(x = c(TRUE, FALSE, NA))

df |> 
  mutate(
    and = x & (NA),
    or = x | NA
  )
```

-   For identifying missing values we use `is.na(x)` function which works with any type of vector and returns TRUE for missing values and FALSE for everything else.

```{r}
is.na(c(TRUE, NA, FALSE))
#> [1] FALSE  TRUE FALSE
is.na(c(1, NA, 3))
#> [1] FALSE  TRUE FALSE
is.na(c("a", NA, "b"))
#> [1] FALSE  TRUE FALSE
```

-   `%in%` is like asking does a set A of values is included in a set B of values

```{r}
1:12 %in% c(1, 5, 11)
```

## What are the logical summery functions we could leverage in R?

-   Main logical summaries: `any()` and `all()`

-   Numeric logical summaries: `mean()` and `sum()` specially when you want to calculate the percentages of applied constraint or condition

## Conditional Transformations using `if_else()` and `case_when()` functions

-   We see these type of transformations everywhere when we clean data

-   Its inspired by the SQL way of doing conditional transformations

-   We use [dplyr::if_else()](https://dplyr.tidyverse.org/reference/if_else.html) when we have just one condition and we want to map it to only two outcomes

```{r}
x <- c(-3:3, NA)
if_else(x > 0, "+ve", "-ve", "???")
```

-   We use dplyr's `case_when()` when we want to map multiple conditions to multiple different outcomes.

```{r}
x <- c(-3:3, NA)
case_when(
  x == 0   ~ "0",
  x < 0    ~ "-ve", 
  x > 0    ~ "+ve",
  is.na(x) ~ "???"
)
```

-   Note that both [`if_else()`](https://dplyr.tidyverse.org/reference/if_else.html) and [`case_when()`](https://dplyr.tidyverse.org/reference/case_when.html) require **compatible** types in the output

## Summary

-   Logical Vectors is just a list of Boolean elements

-   R designed to evaluate logical vectors based on Boolean Algebra rules

-   Logical summaries is a powerful tool for summarizing data based on logic or condition

-   Conditional Transformation is tool for powering data analysis transformation process and also help you answer a Yes Or No questions about the data

## Learning More

-   [r4ds.io/join](r4ds.io/join) for more book clubs!
-   [R Graph Gallery](https://www.r-graph-gallery.com/ggplot2-package.html)
-   The [Graphs section](http://www.cookbook-r.com/Graphs/) of the R Cookbook

## Meeting Videos

### Cohort 5

`r knitr::include_url("https://www.youtube.com/embed/ujOn-4esnDo")`

<details>

<summary>Meeting chat log</summary>

    00:13:43    Njoki Njuki Lucy:   Is it best to visualize the variation in a categorical variable with only two levels using a bar chart? If not, what's the chart to use if I may ask?
    00:16:00    Ryan Metcalf:   Great question Njoki, Categorical, by definition is a set that a variable can have. Say, Male / Female / Other. This example indicates a variable can have three states. It depends on your data set.
    00:16:51    Eileen: bar or pie chart?
    00:16:51    Ryan Metcalf:   There are other forms of presentation other than a bar chart. I.E ‚Äúquantifying‚Äù each category.
    00:18:37    Eileen: box chart
    00:18:46    Njoki Njuki Lucy:   thank you so much  everyone :)
    00:24:31    lucus w:    This website is excellent in determining geom to use: www.data-to-viz.com
    00:25:22    Njoki Njuki Lucy:   awesome, thanks
    00:25:44    Eileen: Box charts are great for showing outliers
    00:26:31    Federica Gazzelloni:    other interesting resources:
    00:26:34    Federica Gazzelloni:    https://www.r-graph-gallery.com/ggplot2-package.html
    00:26:51    Federica Gazzelloni:    http://www.cookbook-r.com/Graphs/
    00:34:19    Amitrajit:  what is the difference in putting aes()  inside geom_count() rather than main ggplot() call?
    00:35:38    Ryan Metcalf:   Like maybe Supply vs Demand curves?
    00:41:16    Federica Gazzelloni:    what about the factor() that we add to a variable when we apply a color?
    00:42:33    Susie Neilson:  I do aes your way Jon!
    00:43:07    Federica Gazzelloni:    and grouping inside the aes
    00:49:27    Amitrajit:  thanks!
    00:49:32    Federica Gazzelloni:    thanks
    00:49:35    Njoki Njuki Lucy:   thank you, bye
    00:49:45    Eileen: Thank you!

</details>

### Cohort 6

`r knitr::include_url("https://www.youtube.com/embed/mYTD9DbM174")`

<details>

<summary>Meeting chat log</summary>

    00:06:21    Matthew Efoli:  good evening Daniel and Esmeralda
    00:07:39    Matthew Efoli:  hello everyone
    00:08:08    Daniel Adereti: Hello Matthew!
    00:08:44    Daniel Adereti: I guess we can start? so we can finish the 2 chapters as Exploratory Data Analysis is quite long and involved
    00:09:04    Freya Watkins:  Sounds good! Hi all :)
    00:10:55    Freya Watkins:  yes can see
    00:23:14    Daniel Adereti: na > Not available
    00:23:32    Maria Eleni Soilemezidi:    rm = remove
    00:25:49    Esmeralda Cruz: yes
    00:26:29    Esmeralda Cruz: to remove the outliers maybe?
    00:29:20    Adeyemi Olusola:    No
    00:29:22    Freya Watkins:  we can't see it no
    00:29:27    Maria Eleni Soilemezidi:    no we can't see it!
    00:29:38    Maria Eleni Soilemezidi:    thank you! Yes
    00:32:57    Daniel Adereti: Cedric's article is a nice one! Helpful to understand descriptive use case of different plot ideas
    00:43:19    Daniel Adereti: we can do the exercises
    00:43:27    Esmeralda Cruz: ok
    00:43:28    Maria Eleni Soilemezidi:    yes, sure!
    00:45:20    Adeyemi Olusola:    we can try reorder
    00:45:28    Adeyemi Olusola:    from the previous example
    00:51:44    Maria Eleni Soilemezidi:    that's a good idea
    00:52:28    Daniel Adereti: Thanks!
    00:52:42    Daniel Adereti: cut_in_color_graph <- diamonds %>% 
      group_by(color, cut) %>% 
      summarise(n = n()) %>% 
      mutate(proportion_cut_in_color = n/sum(n)) %>%
      ggplot(aes(x = color, y = cut))+
      geom_tile(aes(fill = proportion_cut_in_color))+
      labs(fill = "proportion\ncut in color")
    00:53:32    Esmeralda Cruz: üòÆ
    00:53:47    Adeyemi Olusola:    smiles
    00:54:13    Adeyemi Olusola:    but lets try reorder...I think we should be able to pull something from it, though not sure about the heatmap thingy
    00:54:26    Adeyemi Olusola:    on our own though*
    01:05:38    Maria Eleni Soilemezidi:    no worries! Thank you for the presentation, Matthew! :)
    01:05:39    Freya Watkins:  Thanks Matthew!
    01:06:44    Maria Eleni Soilemezidi:    bye everyone, see you next week!

</details>
